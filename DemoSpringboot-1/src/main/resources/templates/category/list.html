<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/main}">
<body>
<section layout:fragment="content">
  <div class="page-header">
    <h2>Danh sách danh mục</h2>
    <a th:href="@{/categories/create}" class="btn-primary">+ Thêm mới</a>
  </div>

  <form method="get" th:action="@{/categories}" class="search-bar">
    <input type="text" name="q" th:value="${q}" placeholder="Tìm theo tên...">
    <button type="submit">Tìm kiếm</button>
  </form>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Tên danh mục</th>
        <th>Người tạo</th>
        <th>Thao tác</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="c : ${page.content}">
        <td th:text="${c.id}"></td>
        <td th:text="${c.name}"></td>
        <td th:text="${c.user != null ? c.user.username : '—'}"></td>
        <td>
          <a th:href="@{'/categories/edit/' + ${c.id}}" class="btn-edit">Sửa</a>
          <form th:action="@{'/categories/delete/' + ${c.id}}" method="post" style="display:inline">
            <button type="submit" class="btn-delete" onclick="return confirm('Xóa danh mục này?')">Xóa</button>
          </form>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="pagination">
    <a th:if="${!page.first}" th:href="@{|/categories?page=${page.number-1}&q=${q}|}">« Trước</a>
    <span th:text="'Trang ' + (${page.number+1}) + ' / ' + ${page.totalPages}"></span>
    <a th:if="${!page.last}" th:href="@{|/categories?page=${page.number+1}&q=${q}|}">Sau »</a>
  </div>
</section>
</body>
</html>
